<?xml version="1.0" encoding="UTF-8"?>
<WebLink xmlns="http://soap.sforce.com/2006/04/metadata">
    <fullName>SVFManagementcButton20210323061014476TkX</fullName>
    <availability>online</availability>
    <displayType>button</displayType>
    <linkType>javascript</linkType>
    <masterLabel>帳票出力 ▾</masterLabel>
    <openType>onClickJavaScript</openType>
    <protected>false</protected>
    <url>/**
 * SVF Dropdown Button for Detail Page onClick JavaScript
 *
 * Generated by SVF Cloud. Do not edit.
 *
 * @version 1.2.0
 */
(function menuBtn(dropDownButton){
  {!REQUIRESCRIPT(&apos;//repo.svfcloud.com/service/sfdc/release-rg/lib/js/jquery-1.8.3.min.js&apos;)};
  {!REQUIRESCRIPT(&apos;/soap/ajax/48.0/connection.js&apos;)};
  {!REQUIRESCRIPT(&apos;/soap/ajax/48.0/apex.js&apos;)};
  {!REQUIRESCRIPT(&apos;/resource/&apos; &amp;  LEFT(SUBSTITUTE(SUBSTITUTE(SUBSTITUTE(TEXT(NOW()),&apos;:&apos;,&apos;&apos;),&apos;-&apos;,&apos;&apos;),&apos; &apos;,&apos;&apos;),10) &amp; &apos;000/svfcloud__SVFPreviewJS&apos;)}

  var dropdownMenuList = document.getElementById(&quot;svfmanagementcbutton20210323061014476tkxSvfMenuList&quot;);
  var top_button_menu = document.getElementById(&quot;topButtonRow&quot;);
  var bottom_button_menu = document.getElementById(&quot;bottomButtonRow&quot;);
  var buttonsJson = &apos;[{&quot;fullName&quot;:&quot;SVFManagementcButton20210323071729728nuM&quot;,&quot;label&quot;:&quot;日整連事故受付表&quot;,&quot;previewSkip&quot;:false},{&quot;fullName&quot;:&quot;SVFManagementcButton20210413003425469BCX&quot;,&quot;label&quot;:&quot;火災新種事故受付票（傷害以外）&quot;,&quot;previewSkip&quot;:false},{&quot;fullName&quot;:&quot;SVFManagementcButton20210413003354431Yty&quot;,&quot;label&quot;:&quot;火災新種事故受付票（傷害）&quot;,&quot;previewSkip&quot;:false},{&quot;fullName&quot;:&quot;SVFManagementcButton20210413022908663pyv&quot;,&quot;label&quot;:&quot;事故受付票（風水災用）&quot;,&quot;previewSkip&quot;:false},{&quot;fullName&quot;:&quot;SVFManagementcButton20210413022946056tcB&quot;,&quot;label&quot;:&quot;事故受付票（地震用）&quot;,&quot;previewSkip&quot;:false},{&quot;fullName&quot;:&quot;SVFManagementcButton20210413023153365Qnm&quot;,&quot;label&quot;:&quot;浜のヨット・モーターボート保険事故受付票&quot;,&quot;previewSkip&quot;:false},{&quot;fullName&quot;:&quot;SVFManagementcButton20210413023106536RFS&quot;,&quot;label&quot;:&quot;第三分野商品事故受付票&quot;,&quot;previewSkip&quot;:false},{&quot;fullName&quot;:&quot;SVFManagementcButton20210413023125368LVA&quot;,&quot;label&quot;:&quot;第三分野商品事故受付票送信&quot;,&quot;previewSkip&quot;:false},{&quot;fullName&quot;:&quot;SVFManagementcButton20210413023539110Km0&quot;,&quot;label&quot;:&quot;代理店契約内容照会カード&quot;,&quot;previewSkip&quot;:false},{&quot;fullName&quot;:&quot;SVFManagementcButton202104130235159631oL&quot;,&quot;label&quot;:&quot;契約内容相違連絡票&quot;,&quot;previewSkip&quot;:false},{&quot;fullName&quot;:&quot;SVFManagementcButton20210413023443038FMh&quot;,&quot;label&quot;:&quot;伝言カード&quot;,&quot;previewSkip&quot;:false},{&quot;fullName&quot;:&quot;SVFManagementcButton202104130237283687CE&quot;,&quot;label&quot;:&quot;現場急行サービス出動依頼書&quot;,&quot;previewSkip&quot;:false},{&quot;fullName&quot;:&quot;SVFManagementcButton20210413023805191DfR&quot;,&quot;label&quot;:&quot;補記&quot;,&quot;previewSkip&quot;:false}]&apos;;

  if ( console &amp;&amp; console.log ) console.log(&apos;svfc button: &apos;+buttonsJson);

  if(dropdownMenuList!=null){
    if(dropdownMenuList.parentNode==top_button_menu){
      top_button_menu.removeChild(dropdownMenuList);
    }else{
      bottom_button_menu.removeChild(dropdownMenuList);
    }
  }

  var print_button = dropDownButton;
  if(print_button.getBoundingClientRect == undefined){
    alert(&apos;\u30C9\u30ED\u30C3\u30D7\u30C0\u30A6\u30F3\u30DC\u30BF\u30F3\u306F\u30D5\u30A3\u30FC\u30C9\u30EC\u30A4\u30A2\u30A6\u30C8\u672A\u5BFE\u5FDC\u3067\u3059\u3002 The drop down button is not supported in feed layout.&apos;);
    return false;
  }

  // get absolute position
  var rect = print_button.getBoundingClientRect() ;
  var positionX = rect.left ;
  var positionY = rect.top ;
  // document and body
  var dElm = document.documentElement , dBody = document.body ;
  // scroll
  var scrollX = dElm.scrollLeft || dBody.scrollLeft ;
  var scrollY = dElm.scrollTop || dBody.scrollTop ;
  // popup position
  var x = positionX + scrollX - 9;
  var y = positionY + scrollY - 76;

  print_button.setAttribute(&quot;onfocusout&quot;,&quot;window.setTimeout(function(){document.getElementById(&apos;svfmanagementcbutton20210323061014476tkxSvfMenuList&apos;).style.display = &apos;none&apos;;},210)&quot;);

  if(dropdownMenuList !=null &amp;&amp; dropdownMenuList.style.display!=&quot;none&quot;){
    if(dropdownMenuList.style.display!=&quot;none&quot;){
      dropdownMenuList.style.display = &quot;none&quot;;
    }
  }else{

    print_button.parentNode.style.position = &quot;relative&quot;; 
    print_button.parentNode.style.cssText+= &quot;z-index: 24&quot;; 
    dropdownMenuList = document.createElement(&quot;div&quot;);
    dropdownMenuList.id = &quot;svfmanagementcbutton20210323061014476tkxSvfMenuList&quot;;
    dropdownMenuList.class = &quot;svfMenu&quot;;
    dropdownMenuList.style.position = &quot;absolute&quot;;
    dropdownMenuList.setAttribute(&quot;style&quot;,&quot;display:block;list-style-type:none;position:absolute;left:&quot;+x +&quot;px;top:&quot;+y+&quot;px;box-shadow:rgba(112, 120, 136, 0.8) 0px 0px 2px 2px;&quot;);

    var menus = JSON.parse(buttonsJson);

    var dropdownMenu;
    var anchorLink;
    for (var menu in menus){
      var printedFlg = (!menus[menu].forbiddenField)
        ? &apos;&apos;
        : menus[menu].forbiddenField;
      dropdownMenu = document.createElement(&quot;div&quot;);
      dropdownMenu.setAttribute(&quot;style&quot;,&quot;padding:2px 10px 2px 10px;background-color: #FAFAFA;&quot;);
      dropdownMenu.setAttribute(&quot;onmouseover&quot;,&quot;this.setAttribute(&apos;style&apos;,&apos;padding:2px 10px 2px 10px;background-color: #EDF8FC;text-decoration:underline;display:block;&apos;);&quot;);
      dropdownMenu.setAttribute(&quot;onmouseout&quot;,&quot;this.setAttribute(&apos;style&apos;,&apos;padding:2px 10px 2px 10px;background-color: #FAFAFA;text-decoration:none;display:block;&apos;);&quot;);
      jQuery(dropdownMenu).on(&apos;mousedown&apos;, {
        sobj: &apos;Management__c&apos;,
        recordId: &apos;{!Management__c.Id}&apos;,
        printedFlg: printedFlg,
        menuTitle: menus[menu].label,
        svfcButtonName: menus[menu].fullName,
        previewSkip: menus[menu].previewSkip,
        sfdcUrl: &apos;{!LEFT($Api.Partner_Server_URL_480,FIND(&quot;/services/Soap/&quot;, $Api.Partner_Server_URL_480)-1)}&apos;
      },
        function (event) {

          var self = event.data;

          if (self.printedFlg != &apos;&apos;) {
            var error_msg = &apos;&apos;;
            try {
              var sobjects =
                sforce.connection.retrieve(
                  self.printedFlg,
                  self.sobj,
                  [self.recordId]);
              var printed_cnt = 0;
              for (var j = 0; j &lt; sobjects.length; j++) {
                if (sobjects[j].get(self.printedFlg) == &apos;true&apos;) {
                  printed_cnt++;
                }
              }
              if (printed_cnt == 1) {
                error_msg = &quot;\u51fa\u529b\u3092\u8a31\u53ef\u3055\u308c\u3066\u3044\u306a\u3044\u30ec\u30b3\u30fc\u30c9\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002 Outputting is not allowed for some records.&quot;;
              } else {
                if (printed_cnt &gt; 0) {
                  error_msg = &quot;\u51fa\u529b\u3092\u8a31\u53ef\u3055\u308c\u3066\u3044\u306a\u3044\u30ec\u30b3\u30fc\u30c9\u304c\u542b\u307e\u308c\u3066\u3044\u307e\u3059\u3002 Outputting is not allowed for some records.&quot;;
                }
              }
            } catch (e) {
              if (e.toString().includes(&apos;sf:INVALID_FIELD&apos;)) {
                var indexColumn = e.toString().indexOf(&apos;No such column &apos;, 0);
                var endOfColumn = e.toString().indexOf(&apos; on entity &apos;, indexColumn + 15);
                var invalid_field = e.toString().substring(indexColumn + 15, endOfColumn);
                error_msg = &quot;\u5FC5\u8981\u306A\u9805\u76EE\u306B\u30A2\u30AF\u30BB\u30B9\u51FA\u6765\u307E\u305B\u3093\u3002\u7BA1\u7406\u8005\u306B\u304A\u554F\u5408\u305B\u4E0B\u3055\u3044\u3002 You can not access the required fields.Please contact your administrator.Field=[&quot; +
                  invalid_field + &apos;]&apos;;
              }
            }
            if (error_msg != &apos;&apos;) {
              console.log(error_msg);
              alert(error_msg);
              return false;
            }
          };
          var target = &apos;svfpreview_&apos; + new Date().getTime();
          var screenLeft = window.screenX;
          var screenTop = window.screenY;

          var form = document.createElement(&apos;form&apos;);
          form.method = &apos;POST&apos;;
          form.action = self.sfdcUrl + &apos;/apex/svfcloud__PreviewPage?appId=&apos; + self.sobj + &apos;&amp;id=&apos; + self.recordId + &apos;&amp;buttonFullName=&apos; + self.svfcButtonName + &apos;&amp;printedFlg=&apos; + self.printedFlg;
          form.target = target;

          function formSubmit() {
            var body = document.getElementsByTagName(&apos;body&apos;)[0];
            body.appendChild(form);
            form.submit();
            body.removeChild(form);
          }

          if (self.previewSkip) {
            var iframePreview = svfcPreview.createIFramePreview();
            iframePreview.start(self.menuTitle, self.svfcButtonName, print_button, target, &apos;classic&apos;, formSubmit);
          } else {
            var popup = window.open(&quot;about:blank&quot;, target, &quot;menubar=no, toolbar=no, scrollbars=yes, resizable=yes, width=600, height=300, top=&quot; + screenTop + &quot;, left=&quot; + screenLeft);
            if (popup) {
              popup.focus();
              formSubmit();
            }
          }

        });
      anchorLink = document.createElement(&quot;a&quot;);
      anchorLink.href=&quot;#&quot;;
      anchorLink.innerText = menus[menu].label;
      anchorLink.setAttribute(&quot;style&quot;,&quot;text-decoration:none;line-height: 20px;&quot;);

      dropdownMenuList.appendChild(dropdownMenu);
      dropdownMenu.appendChild(anchorLink);
    }

    //add menu lists
    print_button.parentNode.appendChild(dropdownMenuList );
    // ajust position
    rect = dropdownMenuList.getBoundingClientRect();
    var pos_x = rect.left;
    var pos_y = rect.top;
    var ajust_x = positionX - pos_x;
    var ajust_y = positionY - pos_y;
    // for ie
    userAgent = window.navigator.userAgent.toLowerCase();
    if ((userAgent.indexOf(&apos;msie&apos;) != -1)||(userAgent.indexOf(&apos;trident&apos;) != -1)) {
      x ++;y-= 4;
    }
    dropdownMenuList.style.left = x+ajust_x+2+&quot;px&quot;;
    dropdownMenuList.style.top = y+ajust_y+23+&quot;px&quot;;
  }
}(element))</url>
</WebLink>
